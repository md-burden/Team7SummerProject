<!DOCTYPE html >
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <meta charset="UTF-8">
    <title>Recipe Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">

    <!-- Using thymeleaf to load style sheet -->
    <link rel="stylesheet" type="text/css" th:href="@{/css/style.css}">


</head>
<body style="background:#FAF4DF">

<!-- Begin Nav Bar -->
<div style="display: flex; flex-direction:column; justify-content:flex-start; align-items: center;">

    <div class="container-fluid" ID="Banner">

        <a class="btn" id="HomeButton" data-th-href="@{/recipe/recent?userId=1}">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" style="display: inline;" class="bi bi-house"
                 viewBox="0 0 16 16">
                <path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
            </svg>
        </a>


        <h1 style="color:#FAF4DF; font-size:32pt; font-family:Tahoma; display: inline;" id="TitleText">Recipeasy</h1>

        <a data-th-href="@{/recipe/create?userId=1}">
            <button class="btn" id="NewRecipeButton">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-circle-plus"
                     viewBox="0 0 16 16">
                    <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
                    <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/>
                </svg>
            </button>
        </a>

        <a data-th-href="@{/recipe/creator/all?userId=1}">
            <button class="btn" id="FavoritesButton">
                <svg xmlns="http://www.w3.org/2000/svg" height=32 width=32 fill="currentColor" class="bi bi-heart-fill"
                     viewBox="0 0 16 16">
                    <path fill-rule="evenodd"
                          d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                </svg>
            </button>
        </a>

        <a data-th-href="@{/user/1}">
            <button class="btn" id="UserIcon">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="bi bi-person-circle"
                     viewBox="0 0 16 16">
                    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                    <path fill-rule="evenodd"
                          d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
                </svg>
            </button>
        </a>
    </div>
</div>
<!--End Banner -->

<form action="#" th:action="@{/recipe/create?userId=1}" method="post">

    <div style="margin: 10px">

        <div class="container-fluid text-start mt-3">
            <div class="row justify-content-between">
                <div class="col-8">


                    <div class="row">
                        <!-- Name Form -->
                        <div class="col mb-4">
                            <label for="recipeTitle" class="form-label fww-bold">Name:</label>
                            <input id="recipeTitle" name="recipeTitle" type="text" class="form-control"
                                   placeholder="Name *"
                                   aria-label="Name">
                        </div>

                        <div class="col mb-4">
                            <label for="recipeCountry" class="form-label fww-bold">Country:</label>
                            <input id="recipeCountry" name="recipeCountry" type="text" class="form-control"
                                   placeholder="Country *"
                                   aria-label="Country">
                        </div>
                    </div>


                    <!-- Row: Time Yield Category -->
                    <div class="row">
                        <!-- Recipe Time -->
                        <div class="col">
                            <label for="time" class="form-label">Time:</label>
                            <input id="time" name="time" type="text" class="form-control" placeholder="Time *"
                                   aria-label="Time">
                        </div>
                        <!-- Recipe Yield -->
                        <div class="col">
                            <label for="yield" class="form-label">Yield:</label>
                            <input id="yield" name="yield" type="text" class="form-control" placeholder="Yield *"
                                   aria-label="Yield">
                        </div>
                        <!-- Recipe Category -->
                        <div class="col">
                            <label for="recipeType" class="form-label">Category:</label>
                            <input id="recipeType"  name="recipeType" type="text" class="form-control"
                                   placeholder="Category *"
                                   aria-label="Category">
                        </div>

                    </div>

                    <div class="row">
                        <div class="col text-start" style="float: left">
                            <!-- Instructions Text Area -->
                            <div class="col">
                                <label for="recipeInstructions" class="form-label">Instructions:</label>
                                <textarea class="form-control"  id="recipeInstructions" name="recipeInstructions"
                                          placeholder="Your instructions here... *"
                                          rows="5"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recipe Image -->
                <!-- TODO: How can I dynamically update the image when a user inputs a URI? -->


                <div class="col-4 justify-content-center text-center">
                    <img src="https://placehold.jp/52/aaa4a8/ffffff/700x700.png?text=No%20Recipe%20Image"
                         alt="..."
                         id="RecipePhoto" style="margin-bottom: 5px;">
                    <input id="recipeImage"  name="recipeImage" type="text" class="form-control"
                           placeholder="Enter image URL here" style="margin-bottom: 0; margin-top: 25px;">
                </div>
            </div>
        </div>

        <div th:fragment="ingredientsList" style="margin-top: 20px;" id="ingredientsList">
            <div th:each="ingredient, iterStat : ${recipe.ingredients}">
                <div class="input-group mt-1" id="ingredients">
                    <span class="input-group-text">Name: </span>
                    <input type="text" th:field="*{ingredient[__${iterStat.index}__].ingredientName}" class="form-control" placeholder="Ingredient Name">
                    <span class="input-group-text">Quantity:</span>
                    <input type="text" th:field="*{ingredient[__${iterStat.index}__].ingredientMeasurment}" class="form-control" placeholder="Quantity">
                    <button type="button" class="btn btn-danger remove-ingredient-button">Remove</button>
                </div>
            </div>

            <button type="button" class="btn btn-primary" id="add-ingredient-button">Add Ingredient</button>
        </div>




    </div>

    <div class="row justify-content-center">
        <div class="col-md-auto" style="margin: 10px 0 10px 0">
            <button class="btn btn-primary" type="submit" id="submit">Create Recipe</button>
        </div>
    </div>
</form>

<script th:inline="javascript">
    /*<![CDATA[*/
    document.addEventListener('DOMContentLoaded', function() {
        const addIngredientButton = document.getElementById('add-ingredient-button');
        const ingredientsList = document.getElementById('ingredientsList');

        addIngredientButton.addEventListener('click', function() {
            const newIngredientIndex = /*[[${recipe.ingredients.size()}]]*/ 0; // Get current size from model

            const newIngredientDiv = document.createElement('div');
            newIngredientDiv.classList.add('input-group', 'mt-1', 'ingredient-input');
            newIngredientDiv.innerHTML = `
            <span class="input-group-text">Name: </span>
            <input type="text" name="ingredients[${newIngredientIndex}].ingredientName" class="form-control" placeholder="Ingredient Name">
            <span class="input-group-text">Quantity:</span>
            <input type="text" name="ingredients[${newIngredientIndex}].ingredientMeasurment" class="form-control" placeholder="Quantity">
            <button type="button" class="btn btn-danger remove-ingredient-button">Remove</button>
        `;

            ingredientsList.insertBefore(newIngredientDiv, addIngredientButton);

            const removeButtons = document.querySelectorAll('.remove-ingredient-button');
            removeButtons.forEach(button => {
                button.addEventListener('click', function() {
                    this.parentElement.remove();
                });
            });
        });
    });
    /*]]>*/
</script>
</body>
</html>


